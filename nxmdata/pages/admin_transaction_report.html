

<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css"/>
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/bootstrap.daterangepicker/2/daterangepicker.css" />
<link rel="stylesheet" href="https://cdn.datatables.net/1.10.10/css/dataTables.bootstrap.min.css"/>

<script src="https://code.jquery.com/jquery-1.11.3.js"></script>
<script src="https://code.jquery.com/ui/1.10.3/jquery-ui.js"></script>
<script src="https://cdn.datatables.net/1.10.10/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.10.10/js/dataTables.bootstrap.min.js"></script>

<!-- Include Date Range Picker -->
<script type="text/javascript" src="https://cdn.jsdelivr.net/momentjs/latest/moment.min.js"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/bootstrap.daterangepicker/2/daterangepicker.js"></script>


<style>
    #overlay {
        position: absolute;
        left: 0;
        top: 0;
        bottom: 0;
        right: 0;
        background: #000;
        opacity: 0.8;
        filter: alpha(opacity=80);
        width: 100%;
        height: 100%;
    }

    #loading {
        width: 50px;
        height: 57px;
        position: absolute;
        /*background: url('img/loading.gif') no-repeat top right;*/
        top: 50%;
        left: 50%;
        margin: -28px 0 0 -25px;
    }

    .daterangepicker {
        width: 310px !important;
    }
    #history{
        width:100% !important;
    }
</style>

<script type="text/javascript">

//var api_url = "https://office.globaltraffictakeover.com:81/";
var api_url = "http://gtt.api/";
var tbl_history;

$(document).ready(function () {

    $('#date_from').daterangepicker({
        singleDatePicker: true,
        showDropdowns: true,
        locale: {
            format: 'YYYY/MM/DD'
        }
    });


	$('#date_to').daterangepicker({
        singleDatePicker: true,
        showDropdowns: true,
        locale: {
            format: 'YYYY/MM/DD'
        }
    });
	

	
	$('#btn_generate').on('click',function(){
		url = api_url + 'orderreports';
		
		var date_from = $('#date_from').val();
		var date_to = $('#date_to').val();
		
		loadOverlay();
		var data = {datefrom:date_from,dateto:date_to};
		
		
		$.ajax({		  
		  url: url,
		  type:"POST",
		  data: data,
		  dataType:'json',
		  success: function(data){
			loadTable(data,"#history");
			removeOverlay();		
		  }
		});
	});

    tbl_history = $("#history").DataTable();
});

function loadTable(data) {

    tbl_history.destroy();
    $('#history tbody').html('');

    $('#history tbody').html('');
    var html = "";
    var total = 0;
    $.each(data, function (index, object) {

        html += "<tr>";
        html += "<td>"+object.user_name+"</td>";
        html += "<td>"+object.sponsor_name+"</td>";
        html += "<td>"+object.sku+"</td>";
        html += "<td>"+object.product_name+"</td>";
        html += "<td>"+object.commission_value+"</td>";
        html += "<td>"+object.purchasedate+"</td>";
        html += "</tr>";

    });

    $('#history tbody').append(html);
    tbl_history = $('#history').DataTable({pageLength:25});
}


function loadOverlay(){
    var overlay = '<div id="overlay"><img id="loading" src="img/loading.gif"></div>';
    $('body').append(overlay);
}

function removeOverlay(){
    $('#overlay').remove();
}

</script>


<br />
<div class="container">
    <h3>Select Dates</h3>
    <div class="row">
        <div class="col-md-3" id="get_commission_type">
            <p><b>From:</b></p>
            <input type="text" class="form-control" id="date_from" />
        </div>


        <div class="col-md-3" id="get_commission_period">
            <div id="get_commission_period_options">
                <p><b>To:</b><p>
            </div>
            <div id="select_commission_period" >
                <input type="text" class="form-control" id="date_to" />
            </div>
        </div>

        <div class="col-md-3" id="get_commissions" >
            <a id="btn_generate" style="margin-top: 30px"  href="javascript:void(0);" class="btn btn-primary"><span class='glyphicon glyphicon-search' aria-hidden='true'></span>&nbsp; View Report</a>

        </div>
    </div>

    <hr />
    <h3>Transaction/Order Reports</h3>
    <div class="row">
        <div class="col-md-12">
            <table class="table table-striped table-bordered"   id="history">
                <thead>
                <tr>
                    <th style="width:20%;">User</th>
                    <th style="width:20%;">Sponsor</th>
                    <th style="width:10%;">Product SKU</th>
                    <th style="width:20%;">Product Name</th>
                    <th style="width:10%;">Volume</th>
                    <th style="width:20%;">Date Purchased</th>
                </tr>
                </thead>
                <tbody>
                </tbody>

            </table>
        </div>
    </div>
</div>

<br />


